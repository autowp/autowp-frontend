<app-moder-rights-tree [roles]="rolesTree"></app-moder-rights-tree>

<table class="table">
  <thead>
    <tr>
      <th>role</th>
      <th>resource</th>
      <th>privilege</th>
      <th>allowed</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let rule of rules">
      <td [textContent]="rule.role"></td>
      <td [textContent]="rule.resource"></td>
      <td [textContent]="rule.privilege"></td>
      <td>
        <i class="fa fa-check-circle" *ngIf="rule.allowed"></i>
        <i class="fa fa-times-circle" *ngIf="!rule.allowed"></i>
      </td>
    </tr>
  </tbody>
</table>

<form name="add-role-parent" class="card card-body form-vertical" (submit)="addRoleParent()">
  <h3 translate>moder/acl/add-parent</h3>
  <div class="form-group">
    <label translate>moder/acl/role</label>
    <select name="role" class="form-control" [(ngModel)]="addRoleParentForm.role" required>
      <option *ngFor="let role of roles" value="{{role.name}}">{{role.name}}</option>
    </select>
  </div>
  <div class="form-group">
    <label translate>moder/acl/parent-role</label>
    <select name="parent_role" class="form-control" [(ngModel)]="addRoleParentForm.parentRole" required>
      <option *ngFor="let role of roles" value="{{role.name}}">{{role.name}}</option>
    </select>
  </div>
  <div>
    <button type="submit" class="btn btn-primary" translate>send</button>
  </div>
</form>

<form name="add-rule" class="card card-body form-vertical" (submit)="addRule()">
  <h3 translate>moder/acl/add-rule</h3>
  <div class="form-group">
    <label translate>moder/acl/role</label>
    <select name="role" class="form-control" [(ngModel)]="addRuleForm.role" required>
      <option *ngFor="let role of roles" value="{{role.name}}">{{role.name}}</option>
    </select>
  </div>
  <div class="form-group">
    <label translate>moder/acl/privilege</label>
    <select name="privilege" class="form-control" [(ngModel)]="addRuleForm.privilege" required>
      <optgroup label="{{resource.name}}" *ngFor="let resource of resources">
        <option *ngFor="let privilege of resource.privileges" value="{{resource.name + '/' + privilege.name}}">{{privilege.name}}</option>
      </optgroup>
    </select>
  </div>
  <div class="form-group">
    <label translate>moder/acl/add-rule/action</label>
    <select name="what" class="form-control" [(ngModel)]="addRuleForm.allowed" required>
      <option value="0">{{'moder/acl/add-rule/action/deny'|translate}}</option>
      <option value="1">{{'moder/acl/add-rule/action/allow'|translate}}</option>
    </select>
  </div>
  <div>
    <button type="submit" class="btn btn-primary" translate>send</button>
  </div>
</form>

<form name="add-role" class="card card-body form-vertical" (submit)="addRole()">
  <h3 translate>moder/acl/add-role</h3>
  <div class="form-group">
    <label translate>moder/acl/role</label>
    <input type="text" class="form-control" maxlength="255" name="name" [(ngModel)]="addRoleForm.name" required />
  </div>
  <div>
    <button type="submit" class="btn btn-primary" translate>send</button>
  </div>
</form>
