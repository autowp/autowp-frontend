<nav aria-label="breadcrumb">
  <ol class="breadcrumb">
    <li class="breadcrumb-item">
      <a routerLink="/" i18n>Index page</a>
    </li>
    <li class="breadcrumb-item">
      <a routerLink="/category" i18n>Categories</a>
    </li>
    <ng-container *ngFor="let item of path$|async; let last = last">
      <li class="breadcrumb-item" *ngIf="!last">
        <a [routerLink]="item.routerLink" [innerHtml]="item.item.name_html" *ngIf="item.item.item_type_id !== 3"></a>
        <div ngbDropdown class="d-inline-block" placement="bottom-right" (openChange)="dropdownOpenChange(item)" *ngIf="item.item.item_type_id === 3">
          <a [routerLink]="item.routerLink" [innerHtml]="item.item.name_html"></a>
          <a ngbDropdownToggle style="cursor:pointer"></a>
          <div ngbDropdownMenu>
            <div class="dropdown-item" *ngIf="!item.loaded">
              <div class="spinner-border" role="status"><span class="visually-hidden" i18n>Loadingâ€¦</span></div>
            </div>
            <a [routerLink]="['/category', child.catname]" class="dropdown-item" [class.active]="child.id === item.item.id" [innerHTML]="child.name_html" *ngFor="let child of item.childs"></a>
          </div>
        </div>
      </li>
    </ng-container>
  </ol>
</nav>
<div class="page-header" *ngIf="current$|async as current">
  <h1 [innerHtml]="current.name_html"></h1>
</div>

<div *ngIf="current$|async as current">

  <ng-container *ngIf="category$|async as category">
    <ng-container *ngIf="isModer$|async as isModer">
      <p *ngIf="isModer" class="mb-4">
        <i class="bi bi-gear-fill" aria-hidden="true"></i>
        <a [routerLink]="['/moder/items/item', current.id]" i18n>edit</a>

        <ng-container *ngIf="canAddCar$|async as canAddCar">
          <span *ngIf="canAddCar">
            <i class="bi bi-plus" aria-hidden="true"></i>
            <a routerLink="/moder/items/new" [queryParams]="{item_type_id: category.item_type_id, parent_id: category.id}">{{getItemTypeTranslation(category.item_type_id, 'add-sub-item')}}</a>
          </span>
        </ng-container>
      </p>
    </ng-container>

    <app-markdown [markdown]="category.description" *ngIf="current.description && current.description.length > 0"></app-markdown>
  </ng-container>

  <app-categories-list-item [item]="itemParent.item.item" [parentRouterLink]="itemParent.parentRouterLink" *ngFor="let itemParent of (itemParents$|async).items"></app-categories-list-item>

  <app-categories-list-item [item]="item" [parentRouterLink]="currentRouterLinkPrefix$|async" *ngIf="item$|async as item"></app-categories-list-item>

  <div class="twins row" *ngIf="pictures$|async as pictures">
    <div class="col-lg-3 col-md-3" *ngFor="let i of pictures">
      <div class="card mb-4">
        <a [routerLink]="i.route">
          <img alt=""
            [src]="i.picture.thumb_medium.src"
            [title]="i.picture.name_text"
            class="card-img-top"
            loading="lazy"
          />
        </a>
      </div>
    </div>
  </div>

  <!--div *ngIf="otherItemsCount > 0">
    <h3 i18n>Other</h3>
    <div class="row">
      <div class="col-md-3" *ngFor="let picture of otherPictures">
        <a [href]="picture.url" class="d-block rounded mb-4">
          <img [src]="picture.src" [title]="picure.name_text" class="rounded w-100 border border-light" />
        </a>
      </div>
    </div>
    <span class="canAddCar">
      <i class="bi bi-text-left" aria-hidden="true"></i>
      <a [routerLink]="['/category', category.catname, 'other']">details ({{otherItemsCount}})</a>
    </span>
  </div>-->

  <ng-container *ngIf="itemParents$|async as itemParents">
    <app-paginator [data]="itemParents.paginator" *ngIf="itemParents.paginator"></app-paginator>
  </ng-container>
  <!--
  <p *ngIf="contributors.length > 0">
      <ng-container i18n>Contributors:</ng-container>
      <app-user [user]="user" *ngFor="let user of contributors"></app-user>
  </p>
  -->
</div>
