<?php
    $this->pageEnv([
        'breadcrumbsReplace' => [
            'pageId'      => 23,
            'breadcrumbs' => $this->breadcrumbs
        ]
    ]);
?>

<div *ngIf="category">

  <p *ngIf="isModer">
    <i class="fa fa-cog"></i>
    <a [routerLink]="['/moder/items/item', category.id]" translate>moder/edit-object</a>

    <span *ngIf="canAddCar">
      <i class="fa fa-plus"></i>
      <a routerLink="/moder/items/new" [queryParams]="{item_type_id: category.item_type_id, parent_id: category.id}">{{'item/type/' + category.item_type_id + '/add-sub-item' | translate}}</a>
    </span>
  </p>

  <app-markdown markdown="category.description" *ngIf="category.description && category.description.length > 0"></app-markdown>

  <div class="car item-list-item" *ngFor="let item of items">
    <h3>
      <span [innerHTML]="item.name_html"></span>
      <sup class="design-brand mx-2" *ngIf="item.design">{{'ng/carlist/designed by'|translate}}
        <a [href]="item.design.url" [textContent]="item.design.name"></a>
      </sup>

      <small *ngIf="item.produced > 1" class="ml-2">
        <span *ngIf="item.produced_exactly" translate [translateParams]="{count: item.produced}">ng/carlist/produced/%1$s</span>
        <span *ngIf="!item.produced_exactly" translate [translateParams]="{count: item.produced}">ng/carlist/produced-about/%1$s</span>
      </small>
      <small translate *ngIf="item.produced == 1" class="ml-2">carlist/produced/one</small>
    </h3>

    <h4 [textContent]="item.name_default" *ngIf="item.name_default"></h4>

    <div class="row" *ngIf="havePhoto(item) && item.preview_pictures.length > 4">
      <div class="col-12 col-lg-6" *ngFor="let picture of item.preview_pictures.slice(0, 1)">
        <a [href]="'/category/' + category.catname + '/pictures/' + picture.picture.identity" *ngIf="picture.picture.thumb_medium" class="d-block rounded mb-4">
          <img [src]="picture.picture.thumb_medium.src" [alt]="picture.picture.name_text" [title]="picture.picture.name_text" class="rounded w-100 border border-light"
          />
        </a>
        <span *ngIf="!picture">&#xa0;</span>
      </div>
      <div class="col-12 col-lg-6">
        <div class="row">
          <div class="col-6" *ngFor="let picture of item.preview_pictures.slice(1)">
            <a [href]="'/category/' + category.catname + '/pictures/' + picture.picture.identity" *ngIf="picture.picture.thumb_medium" class="d-block rounded mb-4">
              <img [src]="picture.picture.thumb_medium.src" [alt]="picture.picture.name_text" [title]="picture.picture.name_text" class="rounded w-100 border border-light"
              />
            </a>
            <span *ngIf="!picture">&#xa0;</span>
          </div>
        </div>
      </div>
    </div>
    <div class="row" *ngIf="havePhoto(item) && item.preview_pictures.length &lt;= 4">
      <div class="col-6 col-lg-3" *ngFor="let picture of item.preview_pictures">
        <a [href]="'/category/' + category.catname + '/pictures/' + picture.picture.identity" *ngIf="picture.picture && picture.picture.thumb_medium" class="d-block rounded mb-4">
          <img [src]="picture.picture.thumb_medium.src" [alt]="picture.picture.name_text" [title]="picture.picture.name_text" class="rounded w-100 border border-light"
          />
        </a>
        <span *ngIf="!picture">&#xa0;</span>
      </div>
    </div>

    <div class="row" *ngIf="!havePhoto(item) && canHavePhoto(item)">
      <div class="col-6 col-lg-3">
        <div class="no-photo rounded w-100 border border-light mb-4" [title]="'carlist/no-photo'|translate">
          <a routerLink="/upload" [queryParams]="{item_id: item.id}" [title]="'carlist/no-photo/add'|translate" class="fa fa-plus-circle text-success"></a>
          <span class="fa fa-camera fa-lg fa-4x" aria-hidden="true"></span>
        </div>
      </div>
    </div>

    <app-markdown class="text" *ngIf="item.description && item.description.length" [markdown]="item.description"></app-markdown>

    <div *ngIf="item.engine_vehicles && item.engine_vehicles.length">
      <p translate>catalogue/engine/mounted-on:</p>
      <ul>
        <li *ngFor="let vehicle of item.engine_vehicles">
          <a [href]="vehicle.url" [innerHTML]="vehicle.name_html"></a>
        </li>
      </ul>
    </div>

    <ul class="list-inline" ngPreserveWhitespaces>

      <li *ngIf="(item.has_text || item.childs_count) && item.item_type_id == 3" class="list-inline-item">
        <i class="fa fa-align-left mr-1"></i>
        <a [routerLink]="['/category', item.catname]">{{'carlist/details'|translate}}
          <span *ngIf="item.childs_count > 1"> ({{item.childs_count}})</span>
        </a>
      </li>

      <li *ngIf="(item.has_text || item.childs_count) && item.item_type_id != 3" class="list-inline-item">
        <i class="fa fa-align-left mr-1"></i>
        <a [routerLink]="['/category', category.catname, 'zzz']">{{'carlist/details'|translate}}
          <span *ngIf="item.childs_count > 1"> ({{item.childs_count}})</span>
        </a>
      </li>

      <li *ngIf="item.item_type_id == 8" class="list-inline-item">
        <i class="fa fa-align-left mr-1"></i>
        <a [routerLink]="['/persons', item.id]">{{'carlist/details'|translate}}</a>
      </li>

      <li *ngIf="item.total_pictures > 4 && item.item_type_id == 3" class="list-inline-item">
        <span class="fa fa-th mr-1"></span>
        <a [routerLink]="['/category', item.catname, 'pictures']">{{'carlist/all pictures'|translate}} ({{item.total_pictures}})</a>
      </li>

      <li *ngIf="item.total_pictures > 4 && item.item_type_id != 3" class="list-inline-item">
          <span class="fa fa-th mr-1"></span>
          <a [routerLink]="['/category', 'zzz', 'pictures']">{{'carlist/all pictures'|translate}} ({{item.total_pictures}})</a>
        </li>

      <li *ngIf="isModer" class="list-inline-item">
        <i class="fa fa-cog mr-1"></i>
        <a [routerLink]="['/moder/items/item', item.id]" translate>moder/edit-object</a>
      </li>

      <li *ngIf="item.can_edit_specs" class="list-inline-item">
        <i class="fa fa-pencil mr-1"></i>
        <a routerLink="/cars/specifications-editor" [queryParams]="{item_id: item.id}" translate>carlist/edit-specs</a>
      </li>
    </ul>
  </div>

  <!--div *ngIf="otherItemsCount > 0">
    <h3 translate>categories/other</h3>
    <div class="row">
      <div class="col-md-3" *ngFor="let picture of otherPictures">
        <a [href]="picture.url" class="d-block rounded mb-4">
          <img [src]="picture.src" [title]="picure.name_text" class="rounded w-100 border border-light" />
        </a>
      </div>
    </div>
    <span class="canAddCar">
      <i class="fa fa-align-left"></i>
      <a [routerLink]="['/category', category.catname, 'other']">{{'carlist/details'|translate}} ({{otherItemsCount}})</a>
    </span>
  </div>-->

  <app-paginator [data]="paginator" *ngIf="paginator"></app-paginator>
  <!--
  <p *ngIf="contributors.length > 0">
      {{'catalogue/specifications/contributors:'|translate}}
      <app-user [user]="user" *ngFor="let user of contributors"></app-user>
  </p>
  -->
</div>
